#其他重要内容  
相关主题：  
+ 指针的类型转换  
+ 访问硬件设备  
+ 别名和强别名  
+ 使用restrict关键字  
+ 线程  
+ 面向对象技术  

回调函数就是允许用户把需要调用的函数的指针作为参数传递给一个函数，以便该函数在处理相似事件的时候可以灵活的使用不同的方法。  
c支持面向对象的方法：  
+ 不透明指针  
+ 在c中实现多态类型  

##转换指针  
转换指针目的包括： 
+ 访问特殊目的地址  
+ 分配一个地址来表示端口  
+ 判断机器的字节序  

**note**:  
机器的字节序一般是指数据类型内部的字节序。两种常见的字节序是小字节序和大字节序。小字节序是指将低位字节存储在低地址，大字节序是指将高位字节存储在低地址  
可以把整数转换为整数指针：  
```c
int num = 9;
int *pi = (int*)num;
```
这允许你访问任何地址，一般会出错  
把指针转换为整数再转换回指针从来不是什么好办法：  
```c
int num;
    int *pi = &num;
    printf("Before: %p\n", pi);
    int tmp = (int)pi;
    pi = (int*)tmp;
    printf("After: %p\n", pi);
    printf("Num Address: %p\n", &num);
```
运行结果：  
```c
Before: 0x7ffd87d8bcd8
After: 0xffffffff87d8bcd8
Num Address: 0x7ffd87d8bcd8
```
可以考虑使用**Union**  
**note: **指针与整数之间的转换和在指针与void指针之间转换不同  

###访问端口  
```c
volatile int i=10;
int a = i;
...
// 其他代码，并未明确告诉编译器，对 i 进行过操作
int b = i;
```
volatile 指出 i 是随时可能发生变化的，每次使用它的时候必须从 i的地址中读取，因而编译器生成的汇编代码会重新从i的地址读取数据放在 b 中。而优化做法是，由于编译器发现两次从 i读数据的代码之间的代码没有对 i 进行过操作，它会自动把上次读的数据放在 b 中。而不是重新从 i 里面读。这样以来，如果 i是一个寄存器变量或者表示一个端口数据就容易出错，所以说 volatile 可以保证对特殊地址的稳定访问。  

###判断机器的字节序  
```c
num = 0x12345678;

    char * pc = (char*)&num;
    for (int i = 0; i < 4; i++)
        printf("%p: %02x \n", pc, (unsigned char)*pc++);
```
运行结果：  
```c
0x7fffbcc7c99d: 78 
0x7fffbcc7c99e: 56 
0x7fffbcc7c99f: 34 
0x7fffbcc7c9a0: 12 
```
低地址存储低位，为小字节序  

##别名/强别名/restrict  
两个指针引用同一地址，称一个指针是另一个指针的别名。当编译器为指针生成代码时，除非特别指定，否则会假设可能存在别名。如果两个指针引用同一位置，那么任何一个都可能修改这个位置，当编译器生成读写这个位置的代码时，不能通过把值放入寄存器来优化性能。  

强别名是另一种别名，不允许一种类型的指针成为i另一种类型的指针的别名  

为了避免别名问题，可以采用技术：  
+ 使用union  
+ 关闭强别名  
+ 使用char指针 

###联合体多种方式表示值  

###restrict关键字  
restrict关键字允许编译器优化某部分代码以更好地支持计算，只能用于指针，表明该指针是访问数据对象唯一且初始的方式  
示例代码  
```c
int arr[10];
    int * restrict restar = (int*)malloc(10 * sizeof(int));
    int *par = arr;

    for (int i = 0; i < 10; i++) {
        par[i] += 5;
        restar[i] += 5;
        arr[i] *= 2;
        par[i] += 3;
        restar[i] += 3;
    }
```
编译器可以把涉及restar的两条语句替换成：  
```c
restar[i] += 8;
```
而par相关的则不行，因为中间arr改变了数据
restrict隐含含义：  
+ 对于编译器，它可以执行某些代码优化  
+ 对于程序员，指针不能有别名  

##线程和指针  


